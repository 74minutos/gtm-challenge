---
import BloqueLayout from '../layouts/BloqueLayout.astro'
import TowerBuilder from '../components/games/TowerBuilder'
---

<BloqueLayout bloqueId="bloque-1" title="La Torre de Control">
  <div class="max-w-4xl mx-auto px-6">
    
    <!-- Hero del bloque -->
    <section class="py-12 text-center">
      <span class="pill mb-4">Bloque 1 Â· 30 min</span>
      <h1 class="text-4xl md:text-5xl font-bold mb-4">
        ğŸ—ï¸ La Torre de Control
      </h1>
      <p class="text-xl text-ink-light max-w-2xl mx-auto">
        Tags, Triggers y Variables: los tres pilares que controlan todo en GTM.
      </p>
    </section>

    <!-- Â¿Por quÃ© nace GTM? -->
    <section class="py-12 border-t border-cream-dark">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold mb-2">Â¿Por quÃ© nace GTM?</h2>
        <span class="pill">La historia real</span>
      </div>

      <p class="text-lg text-center text-ink-light max-w-3xl mx-auto mb-8">
        <strong>2012:</strong> Google se da cuenta de que todos sufren el mismo problema. Cada marketer que quiere medir algo espera a desarrollo. Cada dev estÃ¡ harto. Los datos llegan tarde. <strong>GTM nace para romper ese cuello de botella.</strong>
      </p>

      <div class="grid md:grid-cols-3 gap-6 mb-8">
        <article class="card">
          <h3 class="text-xl font-bold mb-2">ğŸ§° QuÃ© es GTM</h3>
          <p class="text-ink-light mb-4">Un Tag Management System: una capa donde orquestas quÃ© etiquetas se ejecutan, cuÃ¡ndo y cÃ³mo.</p>
          <p class="text-sm text-ink-light border-t-2 border-primary pt-3">
            <strong>En otras palabras:</strong> Es como una "caja de controles" que marketing puede tocar sin tocar cÃ³digo.
          </p>
        </article>
        <article class="card">
          <h3 class="text-xl font-bold mb-2">ğŸš€ QuÃ© resuelve</h3>
          <p class="text-ink-light mb-4">Centraliza scripts, da autonomÃ­a a marketing, reduce deploys riesgosos y alinea equipos.</p>
          <p class="text-sm text-ink-light border-t-2 border-warning pt-3">
            <strong>Resultado:</strong> De "esperar 1 semana" a "hacer cambios en 10 minutos".
          </p>
        </article>
        <article class="card">
          <h3 class="text-xl font-bold mb-2">ğŸ¯ CuÃ¡ndo lo necesitas</h3>
          <p class="text-ink-light mb-4">Cuando tienes mÃºltiples herramientas (GA4, Meta, LinkedIn, etc.) y necesitas cambios rÃ¡pidos sin riesgo.</p>
          <p class="text-sm text-ink-light border-t-2 border-success pt-3">
            <strong>Realidad:</strong> En empresas con {'>'}10 tags, GTM es prÃ¡cticamente obligatorio.
          </p>
        </article>
      </div>

      <p class="text-center font-semibold text-lg mb-6">ğŸ¯ Â¿QuÃ© duele antes de GTM?</p>

      <div class="grid md:grid-cols-3 gap-6 mb-8">
        <div class="card bg-danger/5 border-l-4 border-danger">
          <h4 class="font-bold text-danger mb-3">ğŸ˜¤ Para Marketing</h4>
          <ul class="text-sm text-ink-light space-y-1 list-disc list-inside">
            <li>Esperar 7-14 dÃ­as por cada cambio</li>
            <li>No poder iterar rÃ¡pido en campaÃ±as</li>
            <li>Depender de dev para TODO</li>
            <li>Cambios se bloquean por otros sprints</li>
          </ul>
        </div>
        <div class="card bg-success/5 border-l-4 border-success">
          <h4 class="font-bold text-success mb-3">ğŸ˜¤ Para Desarrollo</h4>
          <ul class="text-sm text-ink-light space-y-1 list-disc list-inside">
            <li>La cola de requests de marketing es infinita</li>
            <li>Insertando tags = tiempo no productivo</li>
            <li>Riesgo: cada deploy puede romper tracking</li>
            <li>Code review para cambios que no aÃ±aden valor</li>
          </ul>
        </div>
        <div class="card bg-secondary/10 border-l-4 border-secondary">
          <h4 class="font-bold text-secondary mb-3">ğŸ˜¤ Para Datos/Analytics</h4>
          <ul class="text-sm text-ink-light space-y-1 list-disc list-inside">
            <li>Implementaciones inconsistentes</li>
            <li>Diferentes equipos hacen tags distinto</li>
            <li>AuditorÃ­a = pesadilla (Â¿quiÃ©n puso esto?)</li>
            <li>Datos de mala calidad â†’ decisiones malas</li>
          </ul>
        </div>
      </div>

      <div class="card bg-gradient-to-br from-success/10 to-primary/5">
        <h3 class="text-xl font-bold mb-4">ğŸ“ˆ Mini timeline: CÃ³mo GTM cambiÃ³ el juego</h3>
        <div class="space-y-3">
          <div class="flex items-start gap-3">
            <span class="step-bullet">ğŸ“…</span>
            <p><strong>2012:</strong> Google lanza GTM. Nadie lo entiende aÃºn.</p>
          </div>
          <div class="flex items-start gap-3">
            <span class="step-bullet">ğŸ“…</span>
            <p><strong>2013-2018:</strong> AdopciÃ³n masiva en e-commerce y medios. Marketing empieza a respirar.</p>
          </div>
          <div class="flex items-start gap-3">
            <span class="step-bullet">ğŸ“…</span>
            <p><strong>2020+:</strong> GA4, server-side y consent mode. GTM deja de ser "herramienta" y se convierte en "arquitectura esencial".</p>
          </div>
          <div class="flex items-start gap-3">
            <span class="step-bullet">ğŸ¯</span>
            <p><strong>HOY:</strong> Sin GTM, no compites. Las empresas que no lo usan pierden meses en cada cambio.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Los tres pilares -->
    <section class="py-12 border-t border-cream-dark">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold mb-2">Los tres pilares de GTM</h2>
        <span class="pill">Framework</span>
      </div>

      <div class="grid md:grid-cols-3 gap-6 mb-8">
        <article class="card">
          <div class="text-4xl mb-4">ğŸ·ï¸</div>
          <h3 class="text-xl font-bold mb-1">Tags</h3>
          <p class="font-semibold text-primary mb-2">Mensajeros que envÃ­an tu data</p>
          <p class="text-ink-light mb-4">Son scripts que se activan para enviar informaciÃ³n a herramientas como GA4, Meta Pixel, LinkedIn, Mixpanelâ€¦</p>
          <p class="text-sm text-ink-light border-l-4 border-primary pl-3">
            <strong>Â¿Por quÃ© importa?</strong> Sin tags, tu web no "habla" con tus herramientas. No sabes quÃ© hace el usuario, no puedes hacer remarketing, no tienes datos para optimizar.
          </p>
        </article>
        <article class="card">
          <div class="text-4xl mb-4">ğŸ¯</div>
          <h3 class="text-xl font-bold mb-1">Triggers</h3>
          <p class="font-semibold text-warning mb-2">Sensores que disparan acciones</p>
          <p class="text-ink-light mb-4">Son reglas que deciden cuÃ¡ndo activar un tag: cuando hacen click, cuando ven un video, cuando llena un formularioâ€¦</p>
          <p class="text-sm text-ink-light border-l-4 border-warning pl-3">
            <strong>Â¿Por quÃ© importa?</strong> Si no tienes triggers precisos, envÃ­as datos incorrectos. Ejemplo: contar un click en un botÃ³n "cerrar" como una compra = mÃ©tricas arruinadas.
          </p>
        </article>
        <article class="card">
          <div class="text-4xl mb-4">ğŸ“¦</div>
          <h3 class="text-xl font-bold mb-1">Variables</h3>
          <p class="font-semibold text-success mb-2">Contexto que aÃ±ade detalle</p>
          <p class="text-ink-light mb-4">Datos auxiliares que acompaÃ±an cada disparo: quÃ© producto se comprÃ³, cuÃ¡nto cuesta, quiÃ©n es el usuarioâ€¦</p>
          <p class="text-sm text-ink-light border-l-4 border-success pl-3">
            <strong>Â¿Por quÃ© importa?</strong> Con variables, pasas de "alguien hizo algo" a "este cliente gastÃ³ â‚¬49 en la categorÃ­a X". Eso es lo que permite optimizar y vender.
          </p>
        </article>
      </div>

      <div class="card bg-gradient-to-br from-secondary/10 to-primary/5 mb-8">
        <h3 class="text-xl font-bold mb-4">ğŸ¬ AnalogÃ­a: Una pelÃ­cula</h3>
        <div class="space-y-3">
          <div class="flex items-start gap-3">
            <span class="step-bullet">ğŸ¥</span>
            <p><strong>Triggers</strong> = El director dice "Â¡ACCIÃ“N!" (detectan momentos clave)</p>
          </div>
          <div class="flex items-start gap-3">
            <span class="step-bullet">ğŸ“¹</span>
            <p><strong>Tags</strong> = Las cÃ¡maras que graban (envÃ­an datos a tus herramientas)</p>
          </div>
          <div class="flex items-start gap-3">
            <span class="step-bullet">ğŸ“</span>
            <p><strong>Variables</strong> = La informaciÃ³n del guiÃ³n (quiÃ©n actÃºa, quÃ© dice, cuÃ¡ndo)</p>
          </div>
        </div>
      </div>

      <p class="text-center font-semibold text-lg mb-6">ğŸ¯ Caso real: Cliente compra en tu tienda</p>

      <div class="grid md:grid-cols-3 gap-4 mb-8">
        <div class="bg-secondary/10 p-4 rounded-xl text-center">
          <p class="text-sm"><strong>ğŸ¯ TRIGGER:</strong> "Click en botÃ³n checkout"</p>
        </div>
        <div class="bg-warning/10 p-4 rounded-xl text-center">
          <p class="text-sm"><strong>ğŸ·ï¸ TAG:</strong> EnvÃ­a "purchase" a GA4</p>
        </div>
        <div class="bg-success/10 p-4 rounded-xl text-center">
          <p class="text-sm"><strong>ğŸ“¦ VARIABLES:</strong> Incluye â‚¬89, "Laptop", user_id</p>
        </div>
      </div>
    </section>

    <!-- Mini-juego: Tower Builder -->
    <section class="py-12 border-t border-cream-dark">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold mb-2">ğŸ® Tu turno: Construye la torre</h2>
        <p class="text-ink-light">Arrastra y suelta para ordenar los pilares correctamente</p>
      </div>
      <TowerBuilder client:visible />
    </section>

    <!-- GTM en el ecosistema -->
    <section class="py-12 border-t border-cream-dark">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold mb-2">GTM en el ecosistema digital</h2>
        <span class="pill">Contexto</span>
      </div>

      <div class="card mb-8">
        <p class="text-lg text-center">
          GTM no vive solo. Es el <strong>centro de operaciones</strong> de tu estrategia de datos.
        </p>
      </div>

      <div class="grid md:grid-cols-3 gap-6 mb-8">
        <article class="card text-center">
          <div class="text-4xl mb-4">ğŸŒ</div>
          <h3 class="text-xl font-bold mb-2">Web / App</h3>
          <p class="text-ink-light">Donde ocurren las interacciones: clicks, scrolls, formularios, compras.</p>
        </article>
        <article class="card text-center border-2 border-primary">
          <div class="text-4xl mb-4">ğŸ–¥ï¸</div>
          <h3 class="text-xl font-bold mb-2">GTM</h3>
          <p class="text-ink-light">Centraliza, controla y orquesta quÃ© datos van a dÃ³nde.</p>
        </article>
        <article class="card text-center">
          <div class="text-4xl mb-4">ğŸ“Š</div>
          <h3 class="text-xl font-bold mb-2">Plataformas</h3>
          <p class="text-ink-light">GA4, Meta, Google Ads, LinkedIn... reciben los datos que GTM traduce.</p>
        </article>
      </div>

      <div class="card bg-gradient-to-br from-primary/10 to-secondary/5">
        <h3 class="text-xl font-bold mb-4">ğŸ­ Casos de uso por industria</h3>
        <div class="grid md:grid-cols-2 gap-4">
          <div class="bg-white/50 p-4 rounded-lg">
            <h4 class="font-bold mb-2">ğŸ›’ E-commerce</h4>
            <p class="text-sm text-ink-light">Tracking de productos, add_to_cart, purchase, remarketing dinÃ¡mico, audiencias de valor.</p>
          </div>
          <div class="bg-white/50 p-4 rounded-lg">
            <h4 class="font-bold mb-2">ğŸ’¼ SaaS B2B</h4>
            <p class="text-sm text-ink-light">Lead forms, trials, feature usage, user journeys, product analytics.</p>
          </div>
          <div class="bg-white/50 p-4 rounded-lg">
            <h4 class="font-bold mb-2">ğŸ“° Media / Content</h4>
            <p class="text-sm text-ink-light">Scroll depth, video engagement, newsletter signups, content performance.</p>
          </div>
          <div class="bg-white/50 p-4 rounded-lg">
            <h4 class="font-bold mb-2">ğŸ¥ Healthcare / Finance</h4>
            <p class="text-sm text-ink-light">Consent-first tracking, server-side para compliance, datos anonimizados.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- MisiÃ³n prÃ¡ctica -->
    <section class="py-12 border-t border-cream-dark">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold mb-2">ğŸ¯ MisiÃ³n: Tu primer evento</h2>
        <span class="pill">PrÃ¡ctica guiada</span>
      </div>

      <div class="card bg-ink text-cream mb-8">
        <h3 class="text-xl font-bold mb-4">Escenario</h3>
        <p class="mb-4">Tu CEO quiere saber cuÃ¡nta gente hace click en el botÃ³n "Solicitar demo" de la landing page.</p>
        <p class="text-primary font-semibold">Tu misiÃ³n: Configurar el tracking de ese click.</p>
      </div>

      <div class="space-y-4 mb-8">
        <div class="card border-l-4 border-primary">
          <div class="flex items-start gap-4">
            <span class="step-bullet">1</span>
            <div>
              <h4 class="font-bold">Identifica el TRIGGER</h4>
              <p class="text-ink-light">Â¿QuÃ© evento debe disparar el tracking? â†’ <strong>Click en elemento</strong></p>
              <p class="text-sm text-ink-light mt-2">ğŸ’¡ Necesitas saber el selector CSS o ID del botÃ³n</p>
            </div>
          </div>
        </div>
        <div class="card border-l-4 border-warning">
          <div class="flex items-start gap-4">
            <span class="step-bullet">2</span>
            <div>
              <h4 class="font-bold">Configura el TAG</h4>
              <p class="text-ink-light">Â¿A dÃ³nde enviamos el dato? â†’ <strong>GA4 Event</strong></p>
              <p class="text-sm text-ink-light mt-2">ğŸ’¡ Event name: "click_demo_button"</p>
            </div>
          </div>
        </div>
        <div class="card border-l-4 border-success">
          <div class="flex items-start gap-4">
            <span class="step-bullet">3</span>
            <div>
              <h4 class="font-bold">AÃ±ade VARIABLES</h4>
              <p class="text-ink-light">Â¿QuÃ© contexto extra enviamos? â†’ <strong>Click Text, Page URL</strong></p>
              <p class="text-sm text-ink-light mt-2">ğŸ’¡ AsÃ­ sabes quÃ© texto tenÃ­a el botÃ³n y en quÃ© pÃ¡gina estaba</p>
            </div>
          </div>
        </div>
      </div>

      <div class="card bg-success/10 border-2 border-success">
        <h4 class="font-bold text-success mb-2">âœ… Resultado esperado</h4>
        <p class="text-ink-light">Cada vez que alguien hace click en "Solicitar demo", GA4 recibe un evento <code class="bg-ink/10 px-2 py-1 rounded">click_demo_button</code> con el texto del botÃ³n y la URL de la pÃ¡gina.</p>
      </div>
    </section>

    <!-- Dominar GTM = Superpoder -->
    <section class="py-12 border-t border-cream-dark">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold mb-2">Dominar GTM = Superpoder</h2>
        <span class="pill">Perspectiva</span>
      </div>

      <div class="grid md:grid-cols-2 gap-6 mb-8">
        <div class="card">
          <h3 class="text-xl font-bold mb-4">ğŸ’° Impacto financiero</h3>
          <ul class="space-y-3">
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span><strong>E-commerce:</strong> +25% conversiÃ³n por mejor tracking de abandono</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span><strong>SaaS:</strong> -40% en CPL por audiencias bien segmentadas</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span><strong>Lead gen:</strong> +60% en calidad de leads atribuidos</span>
            </li>
          </ul>
        </div>
        <div class="card">
          <h3 class="text-xl font-bold mb-4">â° Impacto operativo</h3>
          <ul class="space-y-3">
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span><strong>Velocidad:</strong> De 2 semanas a 10 minutos por cambio</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span><strong>AutonomÃ­a:</strong> Marketing no bloquea desarrollo</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span><strong>Calidad:</strong> Menos errores, mÃ¡s consistencia</span>
            </li>
          </ul>
        </div>
      </div>

      <div class="narrator-box">
        <span class="narrator-icon">ğŸ“</span>
        <div>
          <p class="font-bold mb-2">"GTM es el nuevo inglÃ©s del marketing digital."</p>
          <p class="text-ink-light">No necesitas ser developer. Necesitas entender cÃ³mo fluyen los datos. Y ahora, ya lo entiendes.</p>
        </div>
      </div>
    </section>

    <!-- Resumen y cierre -->
    <section class="py-12 border-t border-cream-dark text-center">
      <div class="text-6xl mb-4">ğŸ†</div>
      <h2 class="text-3xl font-bold mb-4">Bloque 1 Completado</h2>
      
      <div class="card max-w-2xl mx-auto mb-8">
        <h3 class="font-bold mb-4">ğŸ“š Lo que has aprendido:</h3>
        <ul class="text-left space-y-2 text-ink-light">
          <li>âœ… Por quÃ© existe GTM y quÃ© problema resuelve</li>
          <li>âœ… Los tres pilares: Tags, Triggers y Variables</li>
          <li>âœ… CÃ³mo encaja GTM en el ecosistema digital</li>
          <li>âœ… Tu primera misiÃ³n de tracking prÃ¡ctica</li>
          <li>âœ… El impacto real de dominar esta herramienta</li>
        </ul>
      </div>

      <p class="text-xl text-ink-light mb-2">Has construido los cimientos.</p>
      <p class="text-xl font-bold text-primary">Ahora vamos a darle voz a esa torre.</p>
    </section>

  </div>
</BloqueLayout>
